syntax = "proto3";
package chainapi.v1;
option go_package = "github.com/textileio/broker-core/gen/broker/chainapi/v1;chainapi";

message DepositInfo {
  string amount = 1;
  string sender = 2;
  uint64 expiration = 3;
}

message LockInfo {
  string account_id = 1;
  string broker_id = 2;
  DepositInfo deposit = 3;
}

message LockInfoRequest {
  string account_id = 1;
  uint64 block_height = 2;
}

message LockInfoResponse {
  LockInfo lock_info = 1;
}

message HasFundsRequest {
  string broker_id = 1;
  string account_id = 2;
}

message HasFundsResponse {
  bool has_funds = 1;
}

message StateRequest {
}

message StateResponse {
  map<string, LockInfo> locked_funds = 1;
  uint64 block_height = 2;
  string block_hash = 3;
}

service ChainApiService {
  rpc LockInfo(LockInfoRequest) returns (LockInfoResponse) {};
  rpc HasFunds(HasFundsRequest) returns (HasFundsResponse) {}
  rpc State(StateRequest) returns (StateResponse) {};
}
